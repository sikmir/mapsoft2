#!/bin/bash -efu


P=${1:-./ms2tiles}

. ../../modules/test_lib.sh

help_msg="$($P -h ||:)"
assert_cmd "$P" "$help_msg" 1
assert_cmd "$P -h" "$help_msg" 1
assert_cmd "$P --help" "$help_msg" 1
assert_cmd "$P --xxx " "Error: unknown option: --xxx" 1
assert_cmd "$P --range a" "Error: z-index is not set" 1

assert_cmd "$P --range [24.94,60.17] -z 1 a" "Error: unexpected value: a" 1

assert_cmd "$P    -r [24.94,60.17] -z 10" "[582,727,1,1]" 0
assert_cmd "$P -G -r [24.94,60.17] -z 10" "[582,296,1,1]" 0

assert_cmd "$P    -r [24.94,60.17,1,1] -z 10" "[582,727,4,7]" 0
assert_cmd "$P -G -r [24.94,60.17,1,1] -z 10" "[582,290,4,7]" 0

assert_cmd "$P -t [582,727] -z 10" "[24.609375,60.0648405,0.3515625,0.17497071]" 0

assert_cmd "$P -t [582,727] -z 10 -c " "[24.7851562,60.1523258]" 0


assert_cmd "$P -t [582,727] -z 10 -r [24,60,1,1]" "" 0
assert_cmd "$P -t [582,727] -z 10 -r [24,60,0.61,1]" "" 0
assert_cmd "$P -t [582,727] -z 10 -r [24,60,0.60,1]" "" 1
assert_cmd "$P -t [582,727] -z 10 -r [25,60,1,1]" "" 1
