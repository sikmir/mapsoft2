#!/bin/bash -efu


P=${1:-./ms2tiles}

. ../test_lib.sh

help_msg="$($P -h ||:)"
assert "$P -h" "$help_msg" 1
assert "$P --help" "$help_msg" 1
assert "$P --xxx " "$help_msg" 1

assert "$P -p [24.94,60.17] a" "Error: can't parse value: a" 1

assert "$P    -p [24.94,60.17] 10" "[582,727]" 0
assert "$P -G -p [24.94,60.17] 10" "[582,296]" 0

assert "$P    -r [24.94,60.17,1,1] 10" "[582,727,4,7]" 0
assert "$P -G -r [24.94,60.17,1,1] 10" "[582,290,4,7]" 0

assert "$P    -n 582 727 10" "[24.609375,60.0648405,0.3515625,0.17497071]" 0
assert "$P    -c 582 727 10" "[24.7851562,60.1523258]" 0
assert "$P    -t 582 727 10 [24,60,1,1]" "" 0
assert "$P    -t 582 727 10 [24,60,0.61,1]" "" 0
assert "$P    -t 582 727 10 [24,60,0.60,1]" "" 1
assert "$P    -t 582 727 10 [25,60,1,1]" "" 1
