#!/bin/bash -efu


P=${1:-./ms2proj}

. ../test_lib.sh

help_msg="$($P -h ||:)"
assert "$P" "$help_msg" 1
assert "$P --help" "$help_msg" 1
assert "$P -f " "Error: missing argument: -f" 1
assert "$P --xxx " "Error: unknown option: --xxx" 1

assert "$P a " "Error: Can't parse form: a" 1

##################
## points

assert "$P [10,10,10]" "[10,10,10]" 0

assert "$P [10,10,10] [10,10,10]" "[10,10,10]
[10,10,10]" 0

assert "$P -z -t SU39 [39,55]" "[7500118.65,6097339.95,2.45208547]" 0

assert "$P -z -b -f SU39 [39,55]" "[7500118.65,6097339.95,2.45208547]" 0

assert "$P -t SU39 [39,55]" "[7500118.65,6097339.95]" 0

assert "$P -b -t SU39 [7500118.65,6097339.95]" "[39,55]" 0

assert "$P -t FI [31,55]" "[1946707.31,6546912.5]" 0

##################
## lines

assert "$P [[39,55],[40,56]]" "[[39,55],[40,56]]" 0

assert "$P -b -f SU39 [[39,55],[40,57]]"\
  "[[7500118.65,6097339.95],[7515917.6,6153032.39],[7538861.72,6236684.32],[7560889.56,6320468.22]]" 0

assert "$P -a 10 -b -f SU39 [[39,55],[40,57]]"\
  "[[7500118.65,6097339.95],[7560889.56,6320468.22]]" 0

assert "$P -a 0 -b -f SU39 [[39,55],[40,57]]"\
  "[[7500118.65,6097339.95],[7560889.56,6320468.22]]" 0
